commit 8d58c220f92d117ed9de9f6013527184964f644a
Author: Kevin Conner <kev.conner@getupcloud.com>
Date:   Mon Jul 29 08:29:06 2024 -0700

    upgrade base packages and add non-root user
    
    Signed-off-by: Kevin Conner <kev.conner@getupcloud.com>

diff --git a/Dockerfile b/Dockerfile
index 9e4dfe3b1..5699e59e0 100644
--- a/Dockerfile
+++ b/Dockerfile
@@ -1,5 +1,9 @@
 FROM alpine:3.20.0
 RUN apk --no-cache add ca-certificates git
-COPY trivy /usr/local/bin/trivy
+RUN apk upgrade && rm /var/cache/apk/*
+COPY trivy /usr/local/bin/trivy.bin
+RUN echo '#!/bin/sh' > /usr/local/bin/trivy && echo 'umask 002 && echo "umask set to $(umask)" && /usr/local/bin/trivy.bin "$@"' >> /usr/local/bin/trivy && chmod +x /usr/local/bin/trivy
 COPY contrib/*.tpl contrib/
+RUN adduser -u 5000 -D nonroot && addgroup nonroot root
+USER 5000
 ENTRYPOINT ["trivy"]
